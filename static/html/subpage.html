<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>9조 대원 소개</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
    integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="/static/css/subpage.css">

  <script>
    function content_modify() {
      const BTN = document.getElementById('btn');
      const READ = document.querySelectorAll('.tbox');

      BTN.addEventListener("click", function () {
        if (BTN.innerText === '내용 수정') {
          BTN.innerText = '완료';
        } else BTN.innerText = '내용 수정';
      })

      BTN.addEventListener("click", function () {
        if (BTN.innerText === '내용 수정') {
          document.getElementById('target_btn').style.visibility = 'hidden'
        } else { document.getElementById('target_btn').style.visibility = 'visible' }
      })

      READ.forEach((a) => {
        BTN.addEventListener("click", function () {
          if (BTN.innerText === '내용 수정') {
            a.readOnly = true;
          } else {
            a.readOnly = false;
          }
        })
      })

      let name = $('#name').val()
      if (name === '김성훈') {
        console.log('hihi')
      }
    }

    function show_info() {
      $(".team-name").on('click', function (e) {
        let value = e.target.id
        // console.log(value)

        fetch('/input').then(res => res.json()).then(data => {
          let rows = data['result'];

          rows.forEach((a) => {
            let name = a['name'];
            let mbti = a['mbti'];
            let hobby = a['hobby'];
            let merit = a['merit'];
            let style = a['style'];
            let blog = a['blog'];

            if (value === name && name === '김성훈') {
              $('#main-imoji').empty();
              let temp_html2 = `<img class="main-imoji" src="/static/img/KSH.png">`
              $('#main-imoji').append(temp_html2);
            } else if (value === name && name === '조인재') {
              $('#main-imoji').empty();
              let temp_html2 = `<img class="main-imoji" src="/static/img/JIJ.png">`
              $('#main-imoji').append(temp_html2);
            } else if (value === name && name === '김진수') {
              $('#main-imoji').empty();
              let temp_html2 = `<img class="main-imoji" src="/static/img/KJS.png">`
              $('#main-imoji').append(temp_html2);
            } else if (value === name && name === '윤수민') {
              $('#main-imoji').empty();
              let temp_html2 = `<img class="main-imoji" src="/static/img/YSM.png">`
              $('#main-imoji').append(temp_html2);
            } else if (value === name && name === '안홍민') {
              $('#main-imoji').empty();
              let temp_html2 = `<img class="main-imoji" src="/static/img/AHM.png">`
              $('#main-imoji').append(temp_html2);
            }

            if (value === name) {
              $('#controls').empty();
              let temp_html = `<p>
                                  <label for="myname">이름 </label><br>
                                  <input type="text" class="tbox" id="name" value="${name}" readonly>
                                </p>
                                <p>
                                  <label for="mbti">MBTI </label><br>
                                  <input type="text" class="tbox" id="mbti" value="${mbti}" readonly>
                                </p>
                                <p>
                                  <label for="hobby">취미 </label><br>
                                  <input type="text" class="tbox" id="hobby" value="${hobby}" readOnly>
                                </p>
                                <p>
                                  <label for="merit">장점 </label><br>
                                  <input type="text" class="tbox" id="merit" value="${merit}" readOnly>
                                </p>
                                <p>
                                  <label for="blog">블로그 </label><br>
                                  <input type="text" class="tbox" id="blog" value="${blog}" readOnly>
                                </p>
                                <p>
                                  <label for="style">협업 스타일 </label><br>
                                  <input type="text" class="tbox" id="style" value="${style}" readOnly>
                                </p>
                                <p>
                                  <label for="team-sgnt">팀 특징 </label><br>
                                  <input type="text" class="tbox" id="signature" value=":-D" readonly>
                                </p>
                                <p>
                                  <label for="team-goal">팀 목표 </label><br>
                                  <input type="text" class="tbox" id="goal" value=":-D" readonly>
                                </p>
                                <p>
                                  <label for="team-prom">팀 약속 </label><br>
                                  <input type="text" class="tbox" id="promise" value=":-D" readonly>
                                </p>`
              $('#controls').append(temp_html);
            }
          });
        })
      }
      )
    }

    function save_info() {
      let name = $('#name').val();
      let mbti = $('#mbti').val();
      let hobby = $('#hobby').val();
      let merit = $('#merit').val();
      let style = $('#style').val();
      let blog = $('#blog').val();

      let formData = new FormData();
      formData.append('name', name);
      formData.append('mbti', mbti);
      formData.append('hobby', hobby);
      formData.append('merit', merit);
      formData.append('style', style);
      formData.append('blog', blog);

      fetch('/input', { method: "POST", body: formData, }).then((response) => response.json()).then((data) => {
        alert(data["msg"]);
        window.location.reload();
      });
    }
  </script>

</head>

<body>
  <div class="container">
    <section class="box">
      <aside class="box-sidebar">
        <ul class="team-list">
          <label class="member">9조대원 LIST</label>
          <p>
            <li><button onclick="show_info()" class="team-name" id="김성훈">
                <img class="imoji" src="/static/img/KSH.png"> 김성훈</button>
            </li>
          </p>
          <p>
            <li><button onclick="show_info()" class="team-name" id="조인재">
                <img class="imoji" src="/static/img/JIJ.png"> 조인재</button>
            </li>
          </p>
          <p>
            <li><button onclick="show_info()" class="team-name" id="김진수">
                <img class="imoji" src="/static/img/KJS.png"> 김진수</button>
            </li>
          </p>
          <p>
            <li><button onclick="show_info()" class="team-name" id="윤수민">
                <img class="imoji" src="/static/img/YSM.png"> 윤수민</button>
            </li>
          </p>
          <p>
            <li><button onclick="show_info()" class="team-name" id="안홍민">
                <img class="imoji" src="/static/img/AHM.png"> 안홍민</button>
            </li>
          </p>
        </ul>
      </aside>
      <div class="box-contents">
        <div class="content">
          <div id="main-imoji"><img class="main-imoji" src="/static/img/mouse.png"></div>
          <form name="" method="" action="">
            <div class="controls" id="controls">
              <p>
                <label for="name">이름 </label><br>
                <input type="text" class="tbox" id="name" readonly>
              </p>
              <p>
                <label for="mbti">MBTI </label><br>
                <input type="text" class="tbox" id="mbti" readonly>
              </p>
              <p>
                <label for="hobby">취미 </label><br>
                <input type="text" class="tbox" id="hobby" readOnly>
              </p>
              <p>
                <label for="merit">장점 </label><br>
                <input type="text" class="tbox" id="merit" readOnly>
              </p>
              <p>
                <label for="blog">블로그 </label><br>
                <input type="text" class="tbox" id="blog" readOnly>
              </p>
              <p>
                <label for="style">협업 스타일 </label><br>
                <input type="text" class="tbox" id="style" readOnly>
              </p>
              <p>
                <label for="team-sgnt">팀 특징 </label><br>
                <input type="text" class="tbox" id="signature" readonly>
              </p>
              <p>
                <label for="team-goal">팀 목표 </label><br>
                <input type="text" class="tbox" id="goal" readonly>
              </p>
              <p>
                <label for="team-prom">팀 약속 </label><br>
                <input type="text" class="tbox" id="promise" readonly>
              </p>
            </div>
        </div>
        <div class="btn">
          <button type="button" class="submit-btn" onclick="save_info()" id="target_btn">저장/전송</button>
          <button type="button" onclick="content_modify()" id="btn" class="change-btn">내용 수정</button>
        </div>
        </form>
      </div>
    </section>
  </div>
  <button type="button" id="main-btn" class="btn btn-outline-dark">메인페이지</button>
</body>

</html>